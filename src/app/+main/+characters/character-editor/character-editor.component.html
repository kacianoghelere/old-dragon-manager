<layout-base *ngIf="character" pageTitle="Editor de Personagem">
  <form *ngIf="characterForm" [formGroup]="characterForm"
      (ngSubmit)="onSubmit(characterForm)">
    <section class="mb-4">
      <div class="form-group row align-items-center">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right"
            for="characterName">
          <b>Nome</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-8">
          <div class="input-group">
            <input class="form-control form-control-lg"
              type="text"
              id="characterName"
              formControlName="name"
              required>
            <span class="input-group-btn">
              <button class="btn btn-light" type="button" (click)="generateName()">
                <i class="fa fa-cog"></i> Gerar nome
              </button>
            </span>
          </div>
        </div>
      </div>

      <div class="form-group row align-items-start">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right">
          <b>Atributos</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-10">
          <character-editor-attributes *ngIf="characterForm"
            [character]="character"
            [characterForm]="characterForm"></character-editor-attributes>
        </div>
      </div>

      <div class="form-group row align-items-end">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right"
            for="characterLevel">
          <b>Nível do Personagem</b>
        </label>
        <div class="col-sm-12 col-md-2 col-lg-2">
          <input class="form-control"
            type="number"
            id="characterLevel"
            formControlName="level"
            required>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-sm-12 col-md-2 col-form-label text-sm-left text-md-right">
          <b>Raça</b>
        </label>
        <div class="col-sm-12 col-md-10">
          <div class="img-selector">
            <label class="img-radio"
                *ngFor="let characterRace of characterRaces | async; let i = index;"
                [ngClass]="getActive(characterRace.id, 'characterRace')"
                for="race-{{ characterRace.id }}">
              <input type="radio"
                formControlName="characterRace"
                id="race-{{ characterRace.id }}"
                [value]="characterRace.id">
              <div class="card">
                <img class="card-img" [src]="characterRace.picture"
                [alt]="characterRace.name">
                <div class="card-img-overlay d-flex align-items-end">
                  <p class="card-title">
                    <b>{{ characterRace.name }}</b>
                  </p>
                </div>
              </div>
            </label>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-sm-12 col-md-2 col-form-label text-sm-left text-md-right">
          <b>Classe</b>
        </label>
        <div class="col-sm-12 col-md-10">
          <div class="img-selector">
            <label class="img-radio"
                *ngFor="let characterClass of characterClasses | async; let i = index;"
                [ngClass]="getActive(characterClass.id, 'characterClass')"
                for="class-{{ characterClass.id }}">
              <input type="radio"
                formControlName="characterClass"
                id="class-{{ characterClass.id }}"
                [value]="characterClass.id">
              <div class="card">
                <img class="card-img" [src]="characterClass.picture"
                [alt]="characterClass.name">
                <div class="card-img-overlay d-flex align-items-end">
                  <p class="card-title">
                    <b>{{ characterClass.name }}</b>
                  </p>
                </div>
              </div>
            </label>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-sm-12 col-md-2 col-form-label text-sm-left text-md-right"
            for="characterSpecialization">
          <b>Especialização</b>
        </label>
        <div class="col-sm-12 col-md-4">
          <select class="form-control"
              formControlName="characterSpecialization"
              [ngClass]="getErrorClass(characterForm.controls.characterSpecialization)"
              id="characterSpecialization"
              required="false">
            <option value="" selected>Escolha uma especialização</option>
            <option *ngFor="let characterSpecialization of characterSpecializations | async"
                [value]="characterSpecialization.id">
              {{ characterSpecialization.name }}
            </option>
          </select>
        </div>
      </div>

      <hr class="fading-separator">

      <div class="row mb-3">
        <div class="ml-auto col-md-9 col-lg-10">
          <h4>Outras informações</h4>
        </div>
      </div>

      <div class="form-group row align-items-center">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right"
            for="characterPicture">
          <b>Imagem</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-8">
          <div class="input-group">
            <span class="input-group-addon">
              <i class="fa fa-globe"></i>
            </span>
            <input class="form-control"
              type="url"
              id="characterPicture"
              formControlName="picture">
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right"
            for="characterDescription">
          <b>Descrição</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-10">
          <markdown-editor formControlName="description"
              placeholder="Descrição do personagem">
          </markdown-editor>
        </div>
      </div>

      <div class="form-group row align-items-end">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right">
          <b>Características Físicas</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-4">
          <div class="row">
            <div class="col-sm-6 col-md-4 col-lg-4">
              <label for="characterAge">Idade</label>
              <input class="form-control"
              type="number"
              id="characterAge"
              formControlName="age">
            </div>
            <div class="col-sm-6 col-md-4 col-lg-4">
              <label for="characterWeight">Peso</label>
              <input class="form-control"
              type="number"
              id="characterWeight"
              formControlName="weight">
            </div>
            <div class="col-sm-6 col-md-4 col-lg-4">
              <label for="characterHeight">Altura</label>
              <input class="form-control"
              type="number"
              id="characterHeight"
              formControlName="height">
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="mt-4">
      <div class="form-group row">
        <div class="ml-auto col-sm-12 col-md-9 col-lg-10">
          <button class="btn btn-primary btn-lg" type="submit"
              [disabled]="characterForm.invalid">
            <i class="fa fa-save"></i> Salvar Personagem
          </button>
          <button class="btn btn-outline-light btn-lg" type="button" (click)="closeEditor()">
            <i class="fa fa-remove"></i> Cancelar
          </button>
        </div>
      </div>
    </section>
  </form>
</layout-base>
