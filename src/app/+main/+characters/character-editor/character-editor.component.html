<layout-base *ngIf="character" pageTitle="Editor de Personagem">
  <form *ngIf="characterForm" [formGroup]="characterForm"
      (ngSubmit)="onSubmit(characterForm)">
    <section class="mb-4">
      <div class="form-group row align-items-center">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right"
            for="characterName">
          <b>Nome</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-8">
          <div class="input-group">
            <input class="form-control form-control-lg"
              type="text"
              id="characterName"
              formControlName="name"
              required>
            <span class="input-group-btn">
              <button class="btn btn-light" type="button" (click)="generateName()">
                <i class="fa fa-cog"></i> Gerar nome
              </button>
            </span>
          </div>
        </div>
      </div>

      <div class="form-group row align-items-start">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right">
          <b>Atributos</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-10">
          <character-editor-attributes *ngIf="characterForm"
            [character]="character"
            [characterForm]="characterForm"></character-editor-attributes>
        </div>
      </div>

      <div class="form-group row align-items-end">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right"
            for="characterRace">
          <b>Opções</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-10">
          <div class="row">
            <div class="col-sm-12 col-md-auto">
              <label class="col-form-label" for="characterLevel">Nível</label>
              <input class="form-control"
                type="number"
                id="characterLevel"
                formControlName="level"
                required>
            </div>
            <div class="col-sm-12 col-md-auto">
              <label class="col-form-label" for="characterRace">Raça</label>
              <select class="form-control"
                  formControlName="characterRace"
                  [ngClass]="getErrorClass(characterForm.controls.characterRace)"
                  id="characterRace"
                  required>
                  <option value="" selected>Escolha uma raça</option>
                  <option *ngFor="let characterRace of characterRaces | async"
                  [value]="characterRace.id">
                  {{ characterRace.name }}
                </option>
              </select>
            </div>
            <div class="col-sm-12 col-md-auto">
              <label class="col-form-label" for="characterSpecialization">Especialização</label>
              <select class="form-control"
                  formControlName="characterSpecialization"
                  [ngClass]="getErrorClass(characterForm.controls.characterSpecialization)"
                  id="characterSpecialization"
                  required="false">
                <option value="" selected>Escolha uma especialização</option>
                <option *ngFor="let characterSpecialization of characterSpecializations | async"
                    [value]="characterSpecialization.id">
                  {{ characterSpecialization.name }}
                </option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-sm-12 col-md-2 col-form-label text-sm-left text-md-right">
          <b>Classe</b>
        </label>
        <div class="col-sm-12 col-md-10">
          <span class="btn-group btn-group-toggle" data-toggle="buttons">
            <label class="btn btn-outline-light"
                *ngFor="let characterClass of characterClasses | async; let i = index;"
                [ngClass]="getActive(characterClass.id, 'characterClass')">
              <input type="radio"
                formControlName="characterClass"
                [value]="characterClass.id">
              <i class="ra {{characterClass?.style}}"></i> {{characterClass.name}}
            </label>
          </span>
        </div>
      </div>

      <hr class="fading-separator">

      <div class="row mb-3">
        <div class="ml-auto col-md-9 col-lg-10">
          <h4>Outras informações</h4>
        </div>
      </div>

      <div class="form-group row align-items-center">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right"
            for="characterPicture">
          <b>Imagem</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-8">
          <div class="input-group">
            <span class="input-group-addon">
              <i class="fa fa-globe"></i>
            </span>
            <input class="form-control"
              type="url"
              id="characterPicture"
              formControlName="picture">
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right"
            for="characterDescription">
          <b>Descrição</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-10">
          <markdown-editor [markdownControl]="characterForm.controls.description">
            <textarea class="form-control"
              id="characterDescription"
              rows="5"
              formControlName="description"
              placeholder="Descrição do personagem"></textarea>
          </markdown-editor>
        </div>
      </div>

      <div class="form-group row align-items-end">
        <label class="col-sm-12 col-md-3 col-lg-2 col-form-label text-sm-left text-md-right">
          <b>Características Físicas</b>
        </label>
        <div class="col-sm-12 col-md-9 col-lg-4">
          <div class="row">
            <div class="col-sm-6 col-md-4 col-lg-4">
              <label for="characterAge">Idade</label>
              <input class="form-control"
              type="number"
              id="characterAge"
              formControlName="age">
            </div>
            <div class="col-sm-6 col-md-4 col-lg-4">
              <label for="characterWeight">Peso</label>
              <input class="form-control"
              type="number"
              id="characterWeight"
              formControlName="weight">
            </div>
            <div class="col-sm-6 col-md-4 col-lg-4">
              <label for="characterHeight">Altura</label>
              <input class="form-control"
              type="number"
              id="characterHeight"
              formControlName="height">
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="mt-4">
      <div class="form-group row">
        <div class="ml-auto col-sm-12 col-md-9 col-lg-10">
          <button class="btn btn-primary btn-lg" type="submit"
              [disabled]="characterForm.invalid">
            <i class="fa fa-save"></i> Salvar Personagem
          </button>
          <button class="btn btn-outline-light btn-lg" type="button" (click)="goBack()">
            <i class="fa fa-remove"></i> Cancelar
          </button>
        </div>
      </div>
    </section>
  </form>
</layout-base>
